# LingFlow 流程设计器使用指南

## 功能特性

### 1. 整体布局与样式

现代化的四区域布局设计：
- **头部导航栏**：包含Logo、流程名称输入、操作按钮（发布、导出、保存）和模式切换开关
- **中间画布区域**：BPMN流程图编辑器，支持缩放和拖动
- **右侧属性面板**：显示选中元素的详细属性，支持实时编辑

### 2. 视觉设计

- **配色方案**：采用浅色系配色，主色为科技蓝(#409EFF)
- **渐变效果**：头部导航使用紫色渐变背景，营造现代感
- **网格背景**：画布区域使用浅色网格背景，增强设计层次感
- **圆角设计**：所有面板使用12px圆角，柔和美观
- **阴影效果**：适度使用阴影，增加界面深度

### 3. BPMN画布美化

#### 节点样式优化
- 为BPMN节点添加微妙的阴影效果 (`drop-shadow`)
- 鼠标悬停时节点放大并提升亮度 (`transform: scale(1.02)`)
- 选中节点时显示蓝色边框高亮

#### 动态着色功能
通过左侧"节点状态演示"区域，可以为节点设置不同的状态颜色：

- **已完成**（绿色）：显示成功完成的节点
- **进行中**（蓝色）：显示正在执行的节点，带脉冲动画
- **待处理**（橙色）：显示等待处理的节点
- **已失败**（红色）：显示执行失败的节点
- **清除高亮**：移除所有节点的高亮状态

实现方式：
```javascript
// 使用 canvas.addMarker() 方法添加CSS类
canvas.addMarker(element.id, 'completed-highlight')
```

### 4. Viewer模式功能

支持查看模式和编辑模式切换：

#### 查看模式特性
- 集成 `ZoomScrollModule`：支持滚轮缩放
- 集成 `MoveCanvasModule`：支持拖动画布
- 禁用编辑功能，只展示流程图

#### 切换方式
- 点击右上角的开关切换"编辑模式"和"查看模式"
- 切换时自动保留当前流程图状态

### 5. 交互与动效

#### 按钮交互
- 悬停时按钮上移2px (`translateY(-2px)`)
- 增强阴影效果
- 点击时恢复原位
- 平滑的过渡动画（0.3s ease）

#### 工具栏交互
- 工具项悬停时右移并显示背景色
- 激活状态使用蓝色渐变背景

#### 面板动画
- 左侧面板：从左侧滑入动画 (`slideInLeft`)
- 右侧面板：从右侧滑入动画 (`slideInRight`)
- 画布区域：淡入动画 (`fadeIn`)

#### Logo动画
- Logo图标持续脉冲动画，增加活力

### 6. 属性面板功能

#### 基本属性
- 元素类型：显示当前选中元素的类型（开始事件、任务、网关等）
- 元素ID：显示元素的唯一标识
- 元素名称：可编辑的名称字段，实时更新到画布

#### 扩展属性
- 分配人：从模拟用户列表中选择
- 优先级：高(100)、中(50)、低(10)三级
- 描述：多行文本输入

所有属性修改实时同步到BPMN模型。

### 7. 画布操作工具

#### 缩放控制
- **放大按钮**：每次放大10%
- **缩小按钮**：每次缩小10%
- **重置视图**：恢复到100%缩放
- **适应屏幕**：自动调整缩放以完整显示流程图
- **缩放显示**：实时显示当前缩放比例

## 使用说明

### 基本操作

1. **创建流程**
   - 输入流程名称
   - 在画布上拖拽BPMN元素（开始事件、任务、网关、结束事件等）
   - 使用连接工具连接各个节点

2. **编辑属性**
   - 点击画布上的元素选中它
   - 在右侧属性面板中编辑元素信息
   - 修改会实时反映到画布上

3. **节点状态演示**
   - 在左侧"节点状态演示"区域点击状态按钮
   - 查看不同状态下的节点颜色效果
   - 点击"清除高亮"恢复默认状态

4. **切换模式**
   - 点击右上角的模式开关
   - 在编辑模式下可以修改流程图
   - 在查看模式下只能浏览和缩放

5. **保存与导出**
   - **保存XML**：将流程图保存到控制台（开发调试用）
   - **导出**：下载为.bpmn文件
   - **发布流程**：发布到后端服务器

## 技术实现

### 核心依赖

- **Vue 3 + Composition API**：响应式框架
- **bpmn-js**：BPMN 2.0建模和渲染库
- **Element Plus**：UI组件库
- **SCSS**：样式预处理器

### 关键技术点

1. **BPMN.js集成**
   - 使用 `BpmnModeler` 实现编辑功能
   - 使用 `BpmnViewer` 实现查看功能
   - 监听 `selection.changed` 事件处理元素选择

2. **样式定制**
   - 通过 `:deep()` 选择器修改BPMN默认样式
   - 使用CSS变量实现动态主题
   - 添加自定义的标记样式（highlight）

3. **性能优化**
   - 使用 `transition` 和 `transform` 实现GPU加速动画
   - 合理使用事件节流
   - 组件销毁时清理BPMN实例

## 未来扩展

### 计划功能

1. **更多节点类型支持**
   - 子流程
   - 事件子流程
   - 事务子流程

2. **高级属性编辑**
   - 多实例配置
   - 定时器事件
   - 错误处理

3. **流程验证**
   - 语法检查
   - 连接完整性验证
   - 流程可达性分析

4. **模板库**
   - 常用流程模板
   - 自定义模板保存
   - 模板共享

5. **协作功能**
   - 多人同时编辑
   - 变更历史记录
   - 评论和批注

## 注意事项

1. **浏览器兼容性**
   - 推荐使用现代浏览器（Chrome、Firefox、Edge最新版本）
   - 需要支持ES6+和CSS3

2. **性能考虑**
   - 大型流程图（100+节点）可能影响性能
   - 建议合理拆分复杂的业务流程

3. **数据持久化**
   - 当前版本只支持导出XML文件
   - 生产环境需要集成后端存储服务

## 快速开始

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

访问 `http://localhost:3000` 即可使用流程设计器。
